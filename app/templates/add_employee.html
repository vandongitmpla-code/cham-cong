{% extends "base.html" %}
{% block title %}Thêm Nhân viên{% endblock %}
{% block content %}
<div class="section-card">
  <h2 class="section-title">Thêm Nhân viên mới</h2>

  <form method="post" class="mt-3">
    <div class="mb-3">
      <label class="form-label">Mã số</label>
      <input type="text" name="code" class="form-control" required>
    </div>
    <div class="mb-3">
      <label class="form-label">Họ và tên</label>
      <input type="text" name="name" class="form-control" required>
    </div>
    <div class="mb-3">
      <label class="form-label">Tổ</label>
      <input type="text" name="team" class="form-control">
    </div>
    <div class="mb-3">
      <label class="form-label">Phòng ban</label>
      <input type="text" name="department" class="form-control">
    </div>
    <div class="mb-3">
      <label class="form-label">Loại HĐ</label>
      <input type="text" name="contract_type" class="form-control">
    </div>

    <!-- TRƯỜNG CHỌN THÁNG MỚI -->
    <div class="mb-4">
        <label class="form-label">📅 Tháng bắt đầu làm</label>
        <input type="month" name="start_month" id="startMonth" 
               class="form-control form-control-lg" 
               onchange="updateInsuranceMonth()"
               required>
        <div class="form-text">Chọn tháng và năm nhân viên bắt đầu làm việc</div>
    </div>

    <div class="mb-4">
        <div id="insuranceLabel">
            <!-- Hiển thị thông báo bảo hiểm sẽ xuất hiện ở đây -->
        </div>
        <input type="hidden" name="insurance_start_month" id="insuranceMonth">
    </div>

    <button type="submit" class="btn btn-primary btn-lg w-100">
        <i class="bi bi-check-circle"></i> Lưu thông tin
    </button>
</form>
</div>

<script>
function updateInsuranceMonth() {
    const startMonth = document.getElementById('startMonth').value;
    const insuranceLabel = document.getElementById('insuranceLabel');
    const insuranceMonth = document.getElementById('insuranceMonth');
    
    if (startMonth) {
        const [year, month] = startMonth.split('-');
        const insuranceMonthFormatted = `${month}/${year}`;
        
        // Cập nhật label với hiệu ứng
        insuranceLabel.innerHTML = `
            <div class="insurance-display show">
                📅 Bắt đầu đóng bảo hiểm từ tháng: <strong>${insuranceMonthFormatted}</strong>
            </div>
        `;
        insuranceMonth.value = startMonth;
        
        // Tự động focus vào nút Lưu để người dùng dễ thấy
        setTimeout(() => {
            document.querySelector('button[type="submit"]').scrollIntoView({ 
                behavior: 'smooth', 
                block: 'center' 
            });
        }, 300);
        
    } else {
        insuranceLabel.innerHTML = 'Bắt đầu đóng bảo hiểm từ tháng: ';
        insuranceMonth.value = '';
    }
}

// Thêm sự kiện khi trang load xong
document.addEventListener('DOMContentLoaded', function() {
    const startMonthInput = document.getElementById('startMonth');
    
    // Tự động kích hoạt nếu có giá trị mặc định (trong trường hợp edit)
    if (startMonthInput.value) {
        updateInsuranceMonth();
    }
    
    // Thêm placeholder cho input month
    startMonthInput.addEventListener('focus', function() {
        if (!this.value) {
            this.setAttribute('placeholder', 'Chọn tháng/năm');
        }
    });
    
    startMonthInput.addEventListener('blur', function() {
        this.removeAttribute('placeholder');
    });
});
</script>
{% endblock %}