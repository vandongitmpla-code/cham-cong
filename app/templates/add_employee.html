{% extends "base.html" %}
{% block title %}Thêm Nhân viên{% endblock %}
{% block content %}
<div class="section-card">
  <h2 class="section-title">Thêm Nhân viên mới</h2>

  <form method="post" class="mt-3">
    <div class="mb-3">
      <label class="form-label">Mã số</label>
      <input type="text" name="code" class="form-control" required>
    </div>
    <div class="mb-3">
      <label class="form-label">Họ và tên</label>
      <input type="text" name="name" class="form-control" required>
    </div>
    <div class="mb-3">
      <label class="form-label">Tổ</label>
      <input type="text" name="team" class="form-control">
    </div>
    <div class="mb-3">
      <label class="form-label">Phòng ban</label>
      <input type="text" name="department" class="form-control">
    </div>
    <div class="mb-3">
      <label class="form-label">Loại HĐ</label>
      <input type="text" name="contract_type" class="form-control">
    </div>

    <!-- THÊM TRƯỜNG MỚI: THÁNG BẮT ĐẦU LÀM -->
    <div class="mb-3">
      <label class="form-label">Tháng bắt đầu làm</label>
      <input type="month" name="start_month" id="startMonth" class="form-control" onchange="updateInsuranceMonth()">
    </div>

    <div class="mb-3">
      <label class="form-label" id="insuranceLabel">Bắt đầu đóng bảo hiểm từ tháng: </label>
      <input type="hidden" name="insurance_start_month" id="insuranceMonth">
    </div>

    <button type="submit" class="btn btn-primary">Lưu</button>
    <a href="{{ url_for('main.employees') }}" class="btn btn-secondary">Hủy</a>
  </form>
</div>

<script>
function updateInsuranceMonth() {
    const startMonth = document.getElementById('startMonth').value;
    const insuranceLabel = document.getElementById('insuranceLabel');
    const insuranceMonth = document.getElementById('insuranceMonth');
    
    if (startMonth) {
        const [year, month] = startMonth.split('-');
        const insuranceMonthFormatted = `${month}/${year}`;
        
        // Cập nhật label với hiệu ứng
        insuranceLabel.innerHTML = `
            <div class="insurance-display show">
                📅 Bắt đầu đóng bảo hiểm từ tháng: <strong>${insuranceMonthFormatted}</strong>
            </div>
        `;
        insuranceMonth.value = startMonth;
        
        // Tự động focus vào nút Lưu để người dùng dễ thấy
        setTimeout(() => {
            document.querySelector('button[type="submit"]').scrollIntoView({ 
                behavior: 'smooth', 
                block: 'center' 
            });
        }, 300);
        
    } else {
        insuranceLabel.innerHTML = 'Bắt đầu đóng bảo hiểm từ tháng: ';
        insuranceMonth.value = '';
    }
}

// Thêm sự kiện khi trang load xong
document.addEventListener('DOMContentLoaded', function() {
    const startMonthInput = document.getElementById('startMonth');
    
    // Tự động kích hoạt nếu có giá trị mặc định (trong trường hợp edit)
    if (startMonthInput.value) {
        updateInsuranceMonth();
    }
    
    // Thêm placeholder cho input month
    startMonthInput.addEventListener('focus', function() {
        if (!this.value) {
            this.setAttribute('placeholder', 'Chọn tháng/năm');
        }
    });
    
    startMonthInput.addEventListener('blur', function() {
        this.removeAttribute('placeholder');
    });
});
</script>
{% endblock %}